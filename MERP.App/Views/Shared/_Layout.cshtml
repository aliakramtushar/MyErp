<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobicare ERP</title>
    @Styles.Render("~/Content/css")
    @*@Scripts.Render("~/bundles/modernizr")*@

    <link href="~/templateTools/vendor/fontawesome-free/css/all.css" rel="stylesheet" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/templateTools/css/sb-admin.css" rel="stylesheet" />
    <link href="~/templateTools/vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet" />
    <link href="~/Content/Site.css" rel="stylesheet" />
    <link href="~/Content/bootstrap-grid.min.css" rel="stylesheet" />

    @******************************easyui*********************************@
    <link href="~/templateTools/easyui/themes/material/easyui.css" rel="stylesheet" />
    <link href="~/templateTools/easyui/themes/icon.css" rel="stylesheet" />
    <link href="~/templateTools/easyui/themes/color.css" rel="stylesheet" />
    @*<script src="~/templateTools/easyui/plugins/jquery.combotree.js"></script>*@
    @*<script src="~/templateTools/easyui/plugins/jquery.tree.js"></script>*@
    @*<script src="~/templateTools/easyui/plugins/jquery.combotreegrid.js"></script>*@
    @******************************easyui*********************************@
    <script src="~/Scripts/jquery-3.5.1.min.js"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script src="~/templateTools/vendor/jquery-easing/jquery.easing.min.js"></script>

    <script src="~/templateTools/vendor/datatables/jquery.dataTables.js"></script>
    <script src="~/templateTools/vendor/datatables/dataTables.bootstrap4.js"></script>
    <script src="~/templateTools/js/sb-admin.min.js"></script>
    <script src="~/templateTools/js/demo/datatables-demo.js"></script>
    @*<script src="~/templateTools/js/demo/chart-area-demo.js"></script>*@
    @*<script src="~/templateTools/vendor/chart.js/Chart.min.js"></script>*@
    <script src="~/templateTools/easyui/jquery.easyui.min.js"></script>
    <script src="~/Scripts/MCore.js"></script>
    <script src="~/Scripts/MParser.js"></script>
    <script src="~/Scripts/MReport.js"></script>
    <script src="~/Scripts/MAuthentication.js"></script>
    <script src="~/Scripts/excelexportjs.js"></script>
    <script src="~/Scripts/mGlobal.js"></script>
    <script src="~/templateTools/easyui/demo/datagrid/datagrid-export.js"></script>
    <script src="~/templateTools/easyui/plugins/jquery.datagrid.js"></script>
    <script src="~/templateTools/easyui/plugins/jquery.treegrid.js"></script>
    <script src="~/templateTools/sweetalert/sweetalert.min.js"></script>
    <link href="~/templateTools/smallenvelop_pageloader/smallenvelop.css" rel="stylesheet" />
    <link rel="shortcut icon" href="~/Content/img/CompanyLogo-small.ico" />
</head>
<body>
    <div class="merp-pageloader"></div>
    <nav class="navbar navbar-expand static-top" style="background: rgb(255,255,255);background: linear-gradient(158deg, rgba(255,255,255,1) 73%, rgba(163,188,249,0.9640231092436975) 87%, rgba(40,205,38,1) 97%);">
        <a href="/"><img id="imgCompanyLogo" src="~/Content/img/CompanyLogo.png" style="height:45px" class="rounded float-left" alt="Mobicare ERP"></a>
        <label id="lblMUserBranchName" style="margin: 0 auto;font-weight: bold; font-size: 20px;color: darkblue"></label>
        <!-- Navbar -->
        <ul class="navbar-nav ml-auto ml-md-0">
            <li class="nav-item dropdown no-arrow">
                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <label id="lblMUserName" style="color:black; font-weight:bold"></label>
                    <label id="lblMUserGroupName" style="color:white"></label>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                    <div class="dropdown-divider"></div>
                    <a style="background-color:red; color:white" class="dropdown-item" href="#" data-toggle="modal" onclick="Logout()">Logout</a>
                    <a class="dropdown-item" onclick="window.open('http://pms.mobicarebd.com/')" data-toggle="modal">PMS</a>
                    <a class="dropdown-item" onclick="window.open('http://reportportal.edison-bd.com/')" data-toggle="modal">Report Portal</a>
                    <a class="dropdown-item" onclick="window.open('http://csm.edison-bd.com/')" data-toggle="modal">CSM</a>
                    <a class="dropdown-item" onclick="window.open('http://msd.mobicarebd.com/')" data-toggle="modal">MSD</a>
                    <a class="dropdown-item" onclick="window.open('http://servicedesk.mobicarebd.com/')" data-toggle="modal">Service Desk</a>
                    <a class="dropdown-item" onclick="window.open('http://csoms.edison-bd.com/')" data-toggle="modal">CSOMS</a>
                </div>
            </li>
        </ul>
    </nav>
    <div id="wrapper" style="width:100%">
        <div id="MMainLayout" class="easyui-layout" style="width:100%;">
            <div id="regionWest" data-options="region:'west',split:true,hideCollapsedContent:false" title="Mobicare" style="width:18%; min-width:240px">
                <table id="tblMenuTreeGrid" class="easyui-treegrid" data-options="idField:'id',treeField:'text',animate:false," style="width: 100%; height:100%">
                    <thead>
                        <tr>
                            <th field="text" style="font-size:10px">Mobicare ERP Solution</th>
                        </tr>
                    </thead>
                </table>
                @*<img src="~/Content/img/HNY.gif" />*@
                @*<div class="easyui-accordion" data-options="fit:true,border:false,selected:false">
                        <div title="Notification" style="padding:10px;">
                            you have no notification
                        </div>
                    </div>*@
            </div>
            <div data-options="region:'center'" style="width:82%;padding:3px">
                <div class="PageHeader">
                    <label id="lblPageHeader"></label>
                </div>
                <div style="width:100%;padding:5px 3px">
                    @RenderBody()
                </div>
            </div>
            <div class="PageFooter" data-options="region:'south',split:true">
                <label class="PageFooterLabel"> System is developed by Mobicare IT 2020</label>
            </div>
        </div>
    </div>
    @RenderSection("scripts", required: false)
</body>
</html>
<script type="text/javascript">
    var _oMenus = [];
    $(document).ready(function () {
        SetLayoutComponents();
        $(".merp-pageloader").fadeOut("fast");
    });
    function SetLayoutComponents() {
        MUserAuthentication();
        $('#MMainLayout').layout('resize', { width: '100%', height: ($(window).height() - 65) })
        $('#lblMUserName').text(localStorage.getItem('MUserFullName'));
        $('#lblMUserBranchName').text(localStorage.getItem('MUserBranchName'));
        MakeMenuTree();
        var mMainLayout = $('#MMainLayout');
        var west = mMainLayout.layout('panel', 'west');
        var sLoginTime = localStorage.getItem('MUserLoginLime');
        west.panel('setTitle', sLoginTime.substr(0, 28));
    }
    function MakeMenuTree() {
        _oMenus = JSON.parse(localStorage.getItem('MMenus'));
        $("#tblMenuTreeGrid").treegrid('loadData', [_oMenus]);
        if (localStorage.getItem('MSelectedMenuID') != undefined) {
            var nIndex = parseInt(localStorage.getItem('MSelectedMenuID'));
            $('#tblMenuTreeGrid').treegrid('select', nIndex);
            $('#tblMenuTreeGrid').treegrid('expandTo', nIndex);
        }
    }
    $(function () {
        $('#tblMenuTreeGrid').datagrid({
            onSelect: function (rowIndex, rowData) {
                if (rowIndex.ControllerName != 'xxx' || rowIndex.ActionName != 'xxx') {
                    localStorage.setItem('MSelectedMenuID', rowIndex.id);
                    localStorage.setItem('MSelectedMenuActionName', rowIndex.ActionName);
                    window.location.href = '/' + rowIndex.ControllerName + '/' + rowIndex.ActionName
                }
                //if (rowIndex.ControllerName == 'xxx' || rowIndex.ActionName == 'xxx') {
                //    $('#tblMenuTreeGrid').treegrid('toggle', rowIndex.id);
                //}
            },
            onDblClickRow: function (rowIndex, rowData) {
                $('#tblMenuTreeGrid').treegrid('toggle', rowIndex.id);
                //if (rowIndex.state == 'closed') {
                //    $('#tblMenuTreeGrid').treegrid('expand', rowIndex.id);
                //}
                //else {
                //    $('#tblMenuTreeGrid').treegrid('collapse', rowIndex.id);
                //}
            }
        });
    });
    function Logout() {
        MLogout();
    }
    function on() {
        document.getElementById("overlay").style.display = "block";
    }

    function off() {
        document.getElementById("overlay").style.display = "none";
    }
</script>